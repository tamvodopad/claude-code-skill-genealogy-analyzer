#!/usr/bin/env python3
"""
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏–º–µ–Ω–∏ –¥–Ω—é –∫—Ä–µ—â–µ–Ω–∏—è –ø–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–º —Å–≤—è—Ç—Ü–∞–º.
–° –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤-—Ç—ë–∑–æ–∫ –¥–ª—è –∏–º—ë–Ω –Ω–µ –ø–æ —Å–≤—è—Ç—Ü–∞–º.

–¢—Ä–∞–¥–∏—Ü–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–∏–∏:
1. –†–µ–±—ë–Ω–∫–∞ –Ω–∞–∑—ã–≤–∞–ª–∏ –≤ —á–µ—Å—Ç—å —Å–≤—è—Ç–æ–≥–æ, –ø–∞–º—è—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—Ö–æ–¥–∏–ª–∞—Å—å –Ω–∞:
   - –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è
   - 8-–π –¥–µ–Ω—å –æ—Ç —Ä–æ–∂–¥–µ–Ω–∏—è (–¥–µ–Ω—å –Ω–∞—Ä–µ—á–µ–Ω–∏—è –∏–º–µ–Ω–∏)
   - –î–µ–Ω—å –∫—Ä–µ—â–µ–Ω–∏—è
   - –ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–Ω—å –ø–æ—Å–ª–µ —Ä–æ–∂–¥–µ–Ω–∏—è —Å –ø–æ–¥—Ö–æ–¥—è—â–∏–º —Å–≤—è—Ç—ã–º

2. –ï—Å–ª–∏ –∏–º—è –Ω–µ –ø–æ —Å–≤—è—Ç—Ü–∞–º ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ–±—ë–Ω–æ–∫ –Ω–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞:
   - –ë–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏
   - –ö—Ä—ë—Å—Ç–Ω—ã–µ
   - –£–º–µ—Ä—à–∏–µ —Å—Ç–∞—Ä—à–∏–µ –±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã
   - –¢—ë—Ç–∏/–¥—è–¥–∏

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python3 check_nameday.py tree.ged
    python3 check_nameday.py tree.ged --window 8  # –ø–æ–∏—Å–∫ –≤ –æ–∫–Ω–µ ¬±8 –¥–Ω–µ–π
"""

import re
import sys
import argparse
from datetime import date, timedelta
from dataclasses import dataclass, field
from typing import Optional, List, Dict, Set, Tuple

# –ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ —Å–≤—è—Ç—Ü—ã (—é–ª–∏–∞–Ω—Å–∫–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å)
# –§–æ—Ä–º–∞—Ç: (–º–µ—Å—è—Ü, –¥–µ–Ω—å) -> {–º—É–∂—Å–∫–∏–µ –∏–º–µ–Ω–∞}, {–∂–µ–Ω—Å–∫–∏–µ –∏–º–µ–Ω–∞}
# –í–∫–ª—é—á–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è –∫—Ä–µ—Å—Ç—å—è–Ω—Å–∫–æ–π —Å—Ä–µ–¥—ã 19-–Ω–∞—á–∞–ª–∞ 20 –≤–µ–∫–∞

SAINTS_CALENDAR: Dict[Tuple[int, int], Tuple[Set[str], Set[str]]] = {
    # –Ø–ù–í–ê–†–¨
    (1, 1): ({"–ò–ª—å—è", "–ì—Ä–∏–≥–æ—Ä–∏–π", "–¢–∏–º–æ—Ñ–µ–π"}, {"–ê–≥–ª–∞—è"}),
    (1, 2): ({"–ò–≥–Ω–∞—Ç–∏–π", "–ò–≤–∞–Ω", "–î–∞–Ω–∏–∏–ª"}, {"–Æ–ª–∏—è"}),
    (1, 3): ({"–ü—ë—Ç—Ä", "–ú–∏—Ö–∞–∏–ª", "–ù–∏–∫–∏—Ç–∞"}, {"–Æ–ª–∏—è"}),
    (1, 4): ({"–§—ë–¥–æ—Ä", "–î–º–∏—Ç—Ä–∏–π"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (1, 5): ({"–ü–∞–≤–µ–ª", "–§–µ–æ–∫—Ç–∏—Å—Ç"}, {"–ï–≤–≥–µ–Ω–∏—è"}),
    (1, 6): ({"–ù–∏–∫–æ–ª–∞–π", "–ò–Ω–Ω–æ–∫–µ–Ω—Ç–∏–π", "–°–µ—Ä–≥–µ–π"}, {"–ö–ª–∞–≤–¥–∏—è", "–ï–≤–≥–µ–Ω–∏—è"}),
    (1, 7): ({"–ò–≤–∞–Ω", "–í–∞—Å–∏–ª–∏–π"}, set()),  # –†–æ–∂–¥–µ—Å—Ç–≤–æ
    (1, 8): ({"–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–î–∞–≤–∏–¥", "–ï—Ñ–∏–º"}, {"–ê–Ω—Ñ–∏—Å–∞"}),
    (1, 9): ({"–°—Ç–µ—Ñ–∞–Ω", "–§—ë–¥–æ—Ä"}, {"–ê–Ω—Ç–æ–Ω–∏–Ω–∞"}),
    (1, 10): ({"–ù–∏–∫–∞–Ω–æ—Ä", "–ü—ë—Ç—Ä", "–ò–≥–Ω–∞—Ç–∏–π"}, {"–ê–≥–∞—Ñ—å—è", "–î–æ–º–Ω–∞"}),
    (1, 11): ({"–ú–∞—Ä–∫", "–ò–≤–∞–Ω", "–§–µ–æ–¥–æ—Å–∏–π"}, {"–ê–Ω–Ω–∞", "–í–∞—Ä–≤–∞—Ä–∞"}),
    (1, 12): ({"–ê–Ω–∏—Å–∏–π", "–§–∏–ª–∞—Ä–µ—Ç"}, {"–ê–Ω–∏—Å–∏—è", "–ò—Ä–∏–Ω–∞"}),
    (1, 13): ({"–ü—ë—Ç—Ä", "–ú–∏—Ö–∞–∏–ª"}, {"–ú–µ–ª–∞–Ω–∏—è"}),
    (1, 14): ({"–í–∞—Å–∏–ª–∏–π", "–ì—Ä–∏–≥–æ—Ä–∏–π", "–ü–ª–∞—Ç–æ–Ω"}, {"–≠–º–∏–ª–∏—è"}),  # –û–±—Ä–µ–∑–∞–Ω–∏–µ
    (1, 15): ({"–°–∏–ª—å–≤–µ—Å—Ç—Ä", "–°–µ—Ä–∞—Ñ–∏–º"}, {"–Æ–ª–∏—è"}),
    (1, 16): ({"–ì–æ—Ä–¥–µ–π"}, {"–ò—Ä–∏–Ω–∞"}),
    (1, 17): ({"–ê—Ñ–∞–Ω–∞—Å–∏–π", "–ö–∏—Ä–∏–ª–ª", "–§–∏–ª–∏–ø–ø"}, {"–ó–æ—è", "–ï–≤—Ñ–∏–º–∏—è"}),
    (1, 18): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–§–µ–æ–ø–µ–º–ø—Ç"}, {"–°–∏–Ω–∫–ª–∏—Ç–∏–∫–∏—è", "–¢–∞—Ç—å—è–Ω–∞"}),
    (1, 19): ({"–ú–∞–∫–∞—Ä–∏–π", "–§–µ–æ–¥–æ—Å–∏–π"}, {"–ï–≤—Ñ—Ä–∞—Å–∏—è"}),  # –ö—Ä–µ—â–µ–Ω–∏–µ
    (1, 20): ({"–ò–æ–∞–Ω–Ω", "–ï—Ñ–∏–º"}, {"–ï–≤—Ñ–∏–º–∏—è"}),
    (1, 21): ({"–ú–∞–∫—Å–∏–º", "–ù–µ–æ—Ñ–∏—Ç", "–ó–æ—Å–∏–º–∞"}, {"–ê–≥–Ω–∏—è"}),
    (1, 22): ({"–¢–∏–º–æ—Ñ–µ–π", "–ü—ë—Ç—Ä", "–ê–Ω–∞—Å—Ç–∞—Å–∏–π"}, {"–ê–Ω—Ç–æ–Ω–∏–Ω–∞"}),
    (1, 23): ({"–ö–ª–∏–º–µ–Ω—Ç", "–ü–∞–≤–µ–ª"}, {"–ù–∏–Ω–∞"}),
    (1, 24): ({"–ú–∏—Ö–∞–∏–ª", "–§–µ–æ–¥–æ—Å–∏–π"}, {"–ö—Å–µ–Ω–∏—è"}),
    (1, 25): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–°–∞–≤–≤–∞", "–ü—ë—Ç—Ä"}, {"–¢–∞—Ç—å—è–Ω–∞"}),
    (1, 26): ({"–ö—Å–µ–Ω–æ—Ñ–æ–Ω—Ç", "–ò–æ—Å–∏—Ñ"}, {"–ú–∞—Ä–∏—è"}),
    (1, 27): ({"–ò–æ–∞–Ω–Ω", "–ü—ë—Ç—Ä"}, {"–ù–∏–Ω–∞"}),
    (1, 28): ({"–ï—Ñ—Ä–µ–º", "–§–µ–æ–¥–æ—Å–∏–π", "–ü–∞–≤–µ–ª"}, {"–ü–∞–ª–ª–∞–¥–∏—è"}),
    (1, 29): ({"–õ–µ–æ–Ω—Ç–∏–π", "–õ–∞–≤—Ä–µ–Ω—Ç–∏–π"}, set()),
    (1, 30): ({"–ê–Ω—Ç–æ–Ω–∏–π", "–§–µ–æ–¥–æ—Å–∏–π", "–í–∞—Å–∏–ª–∏–π"}, {"–ê–Ω—Ç–æ–Ω–∏–Ω–∞"}),
    (1, 31): ({"–ö–∏—Ä–∏–ª–ª", "–ù–∏–∫–∏—Ç–∞", "–ê—Ñ–∞–Ω–∞—Å–∏–π"}, {"–ö—Å–µ–Ω–∏—è"}),

    # –§–ï–í–†–ê–õ–¨
    (2, 1): ({"–ú–∞–∫–∞—Ä–∏–π", "–°–∞–≤–≤–∞", "–§–µ–æ–¥–æ—Ä"}, set()),
    (2, 2): ({"–ï—Ñ–∏–º", "–ï–≤—Ç–∏—Ö–∏–π"}, {"–ò–Ω–Ω–∞", "–†–∏–º–º–∞"}),  # –°—Ä–µ—Ç–µ–Ω–∏–µ
    (2, 3): ({"–ú–∞–∫—Å–∏–º", "–°–∏–º–µ–æ–Ω", "–ê–Ω–Ω–∞"}, {"–ê–Ω–Ω–∞", "–ê–≥–Ω–∏—è"}),
    (2, 4): ({"–¢–∏–º–æ—Ñ–µ–π", "–ò–≤–∞–Ω"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (2, 5): ({"–ê–≥–∞—Ñ–∞–Ω–≥–µ–ª", "–ö–ª–∏–º–µ–Ω—Ç"}, {"–ê–≥–∞—Ñ—å—è", "–ï–≤–¥–æ–∫–∏—è"}),
    (2, 6): ({"–í—É–∫–æ–ª", "–¢–∏–º–æ—Ñ–µ–π"}, {"–ö—Å–µ–Ω–∏—è", "–ü–∞–≤–ª–∞"}),
    (2, 7): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–í–∏—Ç–∞–ª–∏–π"}, {"–§–∏–ª–∏–ø–ø–∏—è"}),
    (2, 8): ({"–§—ë–¥–æ—Ä", "–ê—Ä–∫–∞–¥–∏–π"}, {"–ú–∞—Ä–∏—è"}),
    (2, 9): ({"–ò–≤–∞–Ω", "–ü—ë—Ç—Ä"}, {"–ê–ø–æ–ª–ª–æ–Ω–∏—è"}),
    (2, 10): ({"–ï—Ñ—Ä–µ–º", "–ü–∞–≤–µ–ª"}, {"–û–ª—å–≥–∞"}),
    (2, 11): ({"–õ–∞–≤—Ä–µ–Ω—Ç–∏–π", "–í–ª–∞—Å–∏–π"}, {"–§—ë–∫–ª–∞"}),
    (2, 12): ({"–ò–≤–∞–Ω", "–í–∞—Å–∏–ª–∏–π", "–ü—ë—Ç—Ä"}, {"–ú–∞—Ä–∏—è", "–ü–µ–ª–∞–≥–µ—è"}),
    (2, 13): ({"–ù–∏–∫–∏—Ç–∞", "–°–∏–º–µ–æ–Ω"}, {"–ï–≤–¥–æ–∫–∏—è"}),
    (2, 14): ({"–¢—Ä–∏—Ñ–æ–Ω", "–í–∞–ª–µ–Ω—Ç–∏–Ω"}, set()),
    (2, 15): ({"–û–Ω–∏—Å–∏–º"}, {"–ò–æ—Ä–¥–∞–Ω–∏—è"}),
    (2, 16): ({"–ü–∞–º—Ñ–∏–ª", "–°–∏–º–µ–æ–Ω"}, {"–ê–Ω–Ω–∞"}),
    (2, 17): ({"–§–µ–æ–¥–æ—Ä", "–ù–∏–∫–æ–ª–∞–π"}, {"–ú–∞—Ä–∏–∞–º–Ω–∞"}),
    (2, 18): ({"–ê–≥–∞—Ñ–æ–Ω", "–§–µ–æ–¥–æ—Å–∏–π"}, {"–ê–≥–∞—Ñ—å—è"}),
    (2, 19): ({"–î–æ—Å–∏—Ñ–µ–π", "–í—É–∫–æ–ª"}, {"–ú–∞—Ä—Ñ–∞"}),
    (2, 20): ({"–õ–µ–≤", "–ü–∞—Ä—Ñ–µ–Ω–∏–π"}, {"–ï–≤–¥–æ–∫–∏—è"}),
    (2, 21): ({"–¢–∏–º–æ—Ñ–µ–π", "–ó–∞—Ö–∞—Ä–∏–π"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞"}),
    (2, 22): ({"–ê—Ñ–∞–Ω–∞—Å–∏–π", "–ü–∞–Ω–∫—Ä–∞—Ç–∏–π"}, {"–ê–Ω–Ω–∞"}),
    (2, 23): ({"–ü—Ä–æ—Ö–æ—Ä", "–•–∞—Ä–ª–∞–º–ø–∏–π"}, {"–í–∞–ª–µ–Ω—Ç–∏–Ω–∞"}),
    (2, 24): ({"–í–ª–∞—Å–∏–π", "–í—Å–µ–≤–æ–ª–æ–¥"}, {"–§–µ–æ–¥–æ—Ä–∞"}),
    (2, 25): ({"–ú–µ–ª–µ—Ç–∏–π", "–ê–ª–µ–∫—Å–µ–π"}, {"–ú–∞—Ä–∏—è"}),  # –ò–≤–µ—Ä—Å–∫–∞—è
    (2, 26): ({"–ú–∞—Ä—Ç–∏–Ω–∏–∞–Ω", "–°—Ç–µ—Ñ–∞–Ω"}, {"–ó–æ—è", "–°–≤–µ—Ç–ª–∞–Ω–∞"}),
    (2, 27): ({"–ö–∏—Ä–∏–ª–ª", "–ú–µ—Ñ–æ–¥–∏–π"}, {"–ú–∞—Ä–∏–∞–Ω–Ω–∞"}),
    (2, 28): ({"–û–Ω–∏—Å–∏–º", "–ü–∞—Ñ–Ω—É—Ç–∏–π"}, {"–ï–≤—Ñ—Ä–æ—Å–∏–Ω–∏—è"}),
    (2, 29): ({"–ö–∞—Å—Å–∏–∞–Ω"}, set()),

    # –ú–ê–†–¢
    (3, 1): ({"–î–∞–Ω–∏–∏–ª", "–ü–∞–≤–µ–ª", "–ú–∞—Ä–∫–µ–ª–ª"}, {"–ï–≤–¥–æ–∫–∏—è"}),
    (3, 2): ({"–§—ë–¥–æ—Ä", "–ú–∏—Ö–∞–∏–ª"}, {"–ú–∞—Ä–∏–∞–º–Ω–∞"}),
    (3, 3): ({"–õ–µ–≤", "–ö–æ—Å–º–∞"}, set()),
    (3, 4): ({"–ê—Ä—Ö–∏–ø", "–§–∏–ª–∏–º–æ–Ω", "–§—ë–¥–æ—Ä"}, {"–ê–ø—Ñ–∏—è"}),
    (3, 5): ({"–õ–µ–≤", "–ê–≥–∞—Ñ–æ–Ω", "–ö–æ—Ä–Ω–∏–ª–∏–π"}, set()),
    (3, 6): ({"–ï–≤—Å—Ç–∞—Ñ–∏–π", "–¢–∏–º–æ—Ñ–µ–π"}, {"–û–ª—å–≥–∞"}),
    (3, 7): ({"–ê—Ñ–∞–Ω–∞—Å–∏–π", "–ü–æ–ª–∏–∫–∞—Ä–ø"}, set()),
    (3, 8): ({"–ü–æ–ª–∏–∫–∞—Ä–ø", "–§–µ–æ—Ñ–∏–ª–∞–∫—Ç"}, set()),
    (3, 9): ({"–ò–≤–∞–Ω", "–¢–∞—Ä–∞—Å–∏–π"}, set()),
    (3, 10): ({"–ü–æ—Ä—Ñ–∏—Ä–∏–π", "–ê–Ω—Ç–æ–Ω"}, set()),
    (3, 11): ({"–°–µ–≤–∞—Å—Ç–∏–∞–Ω", "–°–æ—Ñ—Ä–æ–Ω–∏–π"}, set()),
    (3, 12): ({"–ü—Ä–æ–∫–æ–ø–∏–π", "–§–µ–æ—Ñ–∞–Ω"}, set()),
    (3, 13): ({"–ù–∏–∫–∏—Ñ–æ—Ä", "–í–∞—Å–∏–ª–∏–π"}, {"–ö–∏—Ä–∞", "–ú–∞—Ä–∏–Ω–∞"}),
    (3, 14): ({"–í–µ–Ω–µ–¥–∏–∫—Ç", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, {"–ï–≤–¥–æ–∫–∏—è", "–ê–Ω—Ç–æ–Ω–∏–Ω–∞"}),
    (3, 15): ({"–ê—Ä—Å–µ–Ω–∏–π", "–ê–≥–∞—Ñ–æ–Ω"}, {"–ï–≤—Ñ–∞–ª–∏—è"}),
    (3, 16): ({"–í–∞—Å–∏–ª–∏—Å–∫"}, set()),
    (3, 17): ({"–ì–µ—Ä–∞—Å–∏–º", "–ê–ª–µ–∫—Å–∏–π"}, set()),
    (3, 18): ({"–ö–∏—Ä–∏–ª–ª", "–ê–¥—Ä–∏–∞–Ω"}, set()),
    (3, 19): ({"–•—Ä–∏—Å–∞–Ω—Ñ", "–î–∞—Ä–∏—è"}, {"–î–∞—Ä—å—è"}),
    (3, 20): ({"–ü–∞–≤–µ–ª", "–ï–≤–≥–µ–Ω–∏–π"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞"}),
    (3, 21): ({"–õ–∞–∑–∞—Ä—å", "–§–µ–æ–¥–æ—Å–∏–π"}, set()),
    (3, 22): ({"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ö–∏—Ä–∏–ª–ª"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞"}),
    (3, 23): ({"–ù–∏–∫–æ–Ω", "–í–∏–∫—Ç–æ—Ä"}, set()),
    (3, 24): ({"–°—Ç–µ—Ñ–∞–Ω", "–ï–≤—Ñ–∏–º–∏–π"}, set()),
    (3, 25): ({"–ì–∞–≤—Ä–∏–∏–ª", "–°–∏–º–µ–æ–Ω"}, set()),  # –ë–ª–∞–≥–æ–≤–µ—â–µ–Ω–∏–µ
    (3, 26): ({"–ù–∏–∫–∏—Ñ–æ—Ä", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, set()),
    (3, 27): ({"–í–µ–Ω–µ–¥–∏–∫—Ç", "–§–µ–æ–≥–Ω–æ—Å—Ç"}, set()),
    (3, 28): ({"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ù–∏–∫–∞–Ω–¥—Ä"}, set()),
    (3, 29): ({"–ú–∞—Ä–∫", "–ö–∏—Ä–∏–ª–ª"}, set()),
    (3, 30): ({"–ê–ª–µ–∫—Å–∏–π", "–ú–∞–∫–∞—Ä"}, set()),
    (3, 31): ({"–ö–∏—Ä–∏–ª–ª", "–ê–≤–∏–≤"}, set()),

    # –ê–ü–†–ï–õ–¨
    (4, 1): ({"–ò–≤–∞–Ω", "–î–º–∏—Ç—Ä–∏–π"}, {"–î–∞—Ä—å—è", "–°–æ—Ñ–∏—è"}),
    (4, 2): ({"–ù–∏–∫–∏—Ç–∞", "–í–∏—Å—Å–∞—Ä–∏–æ–Ω"}, set()),
    (4, 3): ({"–°–µ—Ä–∞—Ñ–∏–º", "–§–æ–º–∞"}, set()),
    (4, 4): ({"–í–∞—Å–∏–ª–∏–π", "–ò—Å–∞–∞–∫"}, {"–ê–ø–æ–ª–ª–∏–Ω–∞—Ä–∏—è", "–î–∞—Ä—å—è"}),
    (4, 5): ({"–ù–∏–∫–æ–Ω", "–í–∞—Å–∏–ª–∏–π"}, {"–õ–∏–¥–∏—è", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (4, 6): ({"–ê—Ä—Ç–µ–º–∏–π", "–ó–∞—Ö–∞—Ä–∏–π"}, set()),
    (4, 7): ({"–¢–∏—Ö–æ–Ω", "–°–∞–≤–≤–∞"}, set()),
    (4, 8): ({"–ì–∞–≤—Ä–∏–∏–ª", "–í–∞—Å–∏–ª–∏–π"}, {"–ê–Ω–Ω–∞", "–õ–∞—Ä–∏—Å–∞"}),
    (4, 9): ({"–ü–∞–≤–µ–ª", "–ï—Ñ—Ä–µ–º"}, {"–ú–∞—Ç—Ä–æ–Ω–∞"}),
    (4, 10): ({"–ò–ª–∞—Ä–∏–æ–Ω", "–°—Ç–µ—Ñ–∞–Ω"}, set()),
    (4, 11): ({"–ú–∞—Ä–∫", "–ò–æ–∞–Ω–Ω"}, set()),
    (4, 12): ({"–ò–≤–∞–Ω", "–°–æ—Ñ—Ä–æ–Ω–∏–π"}, set()),
    (4, 13): ({"–ò–Ω–Ω–æ–∫–µ–Ω—Ç–∏–π", "–ò–æ–Ω–∞"}, {"–ê–Ω–Ω–∞"}),
    (4, 14): ({"–ú–∞—Ä—Ç–∏–Ω", "–ï—Ñ–∏–º"}, {"–ú–∞—Ä–∏—è"}),
    (4, 15): ({"–ü–æ–ª–∏–∫–∞—Ä–ø", "–¢–∏—Ç"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (4, 16): ({"–ù–∏–∫–∏—Ç–∞", "–§–µ–æ–¥–æ—Å–∏–π"}, set()),
    (4, 17): ({"–ì–µ–æ—Ä–≥–∏–π", "–ó–æ—Å–∏–º–∞"}, set()),
    (4, 18): ({"–ú–∞—Ä–∫", "–ü–ª–∞—Ç–æ–Ω"}, {"–§–µ–æ–¥–æ—Ä–∞"}),
    (4, 19): ({"–ï–≤—Ç–∏—Ö–∏–π", "–ò–µ—Ä–µ–º–∏—è"}, set()),
    (4, 20): ({"–ì–µ–æ—Ä–≥–∏–π", "–î–∞–Ω–∏–∏–ª"}, set()),
    (4, 21): ({"–†–æ–¥–∏–æ–Ω", "–ò–≤–∞–Ω"}, set()),
    (4, 22): ({"–í–∞–¥–∏–º", "–ì–∞–≤—Ä–∏–∏–ª"}, set()),
    (4, 23): ({"–¢–µ—Ä–µ–Ω—Ç–∏–π", "–ú–∞–∫—Å–∏–º"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ê–Ω—Ç–æ–Ω–∏–Ω–∞"}),
    (4, 24): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–ê–Ω—Ç–∏–ø"}, set()),
    (4, 25): ({"–í–∞—Å–∏–ª–∏–π", "–°–µ—Ä–≥–µ–π"}, set()),
    (4, 26): ({"–ê—Ä—Ç–µ–º–æ–Ω"}, {"–ú–∞—Ä—Ñ–∞"}),
    (4, 27): ({"–ê–Ω—Ç–æ–Ω–∏–π", "–ò–≤–∞–Ω"}, set()),
    (4, 28): ({"–ê–Ω–¥—Ä–µ–π", "–í–∏–∫—Ç–æ—Ä"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (4, 29): ({"–ú–µ–º–Ω–æ–Ω", "–¢–∏–º–æ—Ñ–µ–π"}, {"–ò—Ä–∏–Ω–∞", "–ì–∞–ª–∏–Ω–∞", "–ù–∏–∫–∞"}),
    (4, 30): ({"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–¥—Ä–∏–∞–Ω"}, set()),

    # –ú–ê–ô
    (5, 1): ({"–ö–æ–∑–º–∞", "–í–∏–∫—Ç–æ—Ä"}, {"–¢–∞–º–∞—Ä–∞"}),
    (5, 2): ({"–ò–≤–∞–Ω", "–ì–µ–æ—Ä–≥–∏–π"}, set()),
    (5, 3): ({"–§–µ–æ–¥–æ—Ä", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, set()),
    (5, 4): ({"–§—ë–¥–æ—Ä", "–ê–ª–µ–∫—Å–µ–π"}, set()),
    (5, 5): ({"–ö–ª–∏–º–µ–Ω—Ç", "–í–∏—Ç–∞–ª–∏–π"}, set()),
    (5, 6): ({"–ì–µ–æ—Ä–≥–∏–π", "–ê–Ω–∞—Ç–æ–ª–∏–π"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–í–∞–ª–µ—Ä–∏—è"}),
    (5, 7): ({"–°–∞–≤–≤–∞", "–ê–ª–µ–∫—Å–µ–π"}, {"–ï–ª–∏–∑–∞–≤–µ—Ç–∞"}),
    (5, 8): ({"–ú–∞—Ä–∫", "–°–µ—Ä–≥–µ–π"}, {"–ù–∏–∫–∞"}),
    (5, 9): ({"–°—Ç–µ—Ñ–∞–Ω", "–í–∞—Å–∏–ª–∏–π"}, {"–ì–ª–∞—Ñ–∏—Ä–∞"}),
    (5, 10): ({"–°–∏–º–µ–æ–Ω", "–ù–∏–∫–æ–ª–∞–π"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (5, 11): ({"–ö–∏—Ä–∏–ª–ª", "–ú–µ—Ñ–æ–¥–∏–π"}, set()),
    (5, 12): ({"–í–∞—Å–∏–ª–∏–π", "–ò–æ–∞–Ω–Ω"}, set()),
    (5, 13): ({"–ù–∏–∫–∏—Ç–∞", "–ò–≥–Ω–∞—Ç–∏–π"}, {"–ì–ª–∏–∫–µ—Ä–∏—è"}),
    (5, 14): ({"–ú–∞–∫–∞—Ä–∏–π", "–ù–∏–∫–∏—Ç–∞"}, {"–¢–∞–º–∞—Ä–∞", "–ù–∏–Ω–∞"}),
    (5, 15): ({"–ë–æ—Ä–∏—Å", "–ì–ª–µ–±"}, {"–ó–æ—è"}),
    (5, 16): ({"–¢–∏–º–æ—Ñ–µ–π", "–§–µ–æ–¥–æ—Å–∏–π"}, {"–ú–∞–≤—Ä–∞"}),
    (5, 17): ({"–ù–∏–∫–∏—Ç–∞", "–ü–µ–ª–∞–≥–µ–π"}, set()),
    (5, 18): ({"–ò—Ä–∏–Ω–∞"}, {"–ò—Ä–∏–Ω–∞"}),
    (5, 19): ({"–ò–æ–≤", "–ú–∏—Ö–µ–π"}, set()),
    (5, 20): ({"–§–∞–¥–¥–µ–π", "–°—Ç–µ—Ñ–∞–Ω"}, set()),
    (5, 21): ({"–ò–≤–∞–Ω", "–ê—Ä—Å–µ–Ω–∏–π"}, set()),
    (5, 22): ({"–ù–∏–∫–æ–ª–∞–π"}, {"–ï–ª–µ–Ω–∞"}),  # –ù–∏–∫–æ–ª–∞ –í–µ—à–Ω–∏–π
    (5, 23): ({"–°–∏–º–æ–Ω", "–ê–ª—Ñ–µ–π"}, {"–ò—Å–∏–¥–æ—Ä–∞", "–¢–∞–∏—Å–∏—è"}),
    (5, 24): ({"–ö–∏—Ä–∏–ª–ª", "–ú–µ—Ñ–æ–¥–∏–π"}, set()),
    (5, 25): ({"–ì–µ—Ä–º–∞–Ω", "–î–∏–æ–Ω–∏—Å–∏–π"}, set()),
    (5, 26): ({"–ì–µ–æ—Ä–≥–∏–π", "–°–µ—Ä–≥–µ–π"}, {"–ò—Ä–∏–Ω–∞", "–ì–ª–∏–∫–µ—Ä–∏—è"}),
    (5, 27): ({"–ù–∏–∫–∏—Ç–∞", "–ò—Å–∏–¥–æ—Ä"}, set()),
    (5, 28): ({"–ü–∞—Ö–æ–º–∏–π", "–î–º–∏—Ç—Ä–∏–π"}, set()),
    (5, 29): ({"–§–µ–æ–¥–æ—Ä", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, {"–ú—É–∑–∞", "–§–µ–æ–¥–æ—Å–∏—è"}),
    (5, 30): ({"–ê–Ω–¥—Ä–æ–Ω–∏–∫", "–°—Ç–µ—Ñ–∞–Ω"}, {"–ï–≤—Ñ—Ä–æ—Å–∏–Ω–∏—è"}),
    (5, 31): ({"–§–µ–æ–¥–æ—Ç", "–î–∞–≤–∏–¥"}, {"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", "–ö–ª–∞–≤–¥–∏—è", "–ï–≤—Ñ—Ä–∞—Å–∏—è"}),

    # –ò–Æ–ù–¨
    (6, 1): ({"–ò–≤–∞–Ω", "–î–º–∏—Ç—Ä–∏–π"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (6, 2): ({"–ù–∏–∫–∏—Ç–∞", "–ê–ª–µ–∫—Å–µ–π"}, set()),
    (6, 3): ({"–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–ï–ª–µ–Ω–∞"}, {"–ï–ª–µ–Ω–∞"}),
    (6, 4): ({"–§–∞–¥–¥–µ–π", "–î–∞–Ω–∏–∏–ª"}, {"–°–æ—Ñ–∏—è"}),
    (6, 5): ({"–õ–µ–æ–Ω—Ç–∏–π", "–ê—Ñ–∞–Ω–∞—Å–∏–π"}, {"–ï–≤—Ñ—Ä–æ—Å–∏–Ω–∏—è"}),
    (6, 6): ({"–°–∏–º–µ–æ–Ω", "–ù–∏–∫–∏—Ç–∞"}, set()),
    (6, 7): ({"–ò–≤–∞–Ω", "–§–µ–æ–¥–æ—Ç"}, set()),
    (6, 8): ({"–ì–µ–æ—Ä–≥–∏–π", "–ö–∞—Ä–ø"}, set()),
    (6, 9): ({"–ù–∏–ª", "–§–µ–æ–¥–æ—Ä"}, set()),
    (6, 10): ({"–ù–∏–∫–∏—Ç–∞", "–ò–≥–Ω–∞—Ç–∏–π"}, set()),
    (6, 11): ({"–ê–Ω–¥—Ä–µ–π", "–ò–≤–∞–Ω"}, {"–§–µ–æ–¥–æ—Å–∏—è"}),
    (6, 12): ({"–ò—Å–∞–∞–∫", "–û–Ω—É—Ñ—Ä–∏–π"}, set()),
    (6, 13): ({"–ê–Ω–¥—Ä–æ–Ω–∏–∫", "–ï—Ä–º–∏–π"}, set()),
    (6, 14): ({"–î–∏–æ–Ω–∏—Å–∏–π", "–ï–ª–∏—Å–µ–π"}, set()),
    (6, 15): ({"–ù–∏–∫–∏—Ñ–æ—Ä", "–ò–≤–∞–Ω"}, {"–Æ–ª–∏–∞–Ω–∏—è"}),
    (6, 16): ({"–õ—É–∫–∏–ª–ª–∏–∞–Ω", "–ü–∞–≤–µ–ª", "–¢–∏—Ö–æ–Ω"}, set()),
    (6, 17): ({"–ú–∏—Ç—Ä–æ—Ñ–∞–Ω", "–ü—ë—Ç—Ä"}, {"–ú–∞—Ä—Ñ–∞"}),
    (6, 18): ({"–õ–µ–æ–Ω—Ç–∏–π", "–î–æ—Ä–æ—Ñ–µ–π"}, set()),
    (6, 19): ({"–í–∏—Å—Å–∞—Ä–∏–æ–Ω", "–ò–ª–∞—Ä–∏–æ–Ω"}, {"–§—ë–∫–ª–∞"}),
    (6, 20): ({"–§–µ–æ–¥–æ—Ç", "–ü–∞–≤–µ–ª"}, set()),
    (6, 21): ({"–ï—Ñ—Ä–æ—Å–∏–Ω", "–ú–µ—Ñ–æ–¥–∏–π"}, set()),
    (6, 22): ({"–ö–∏—Ä–∏–ª–ª", "–ê–ª–µ–∫—Å–∏–π"}, set()),
    (6, 23): ({"–¢–∏–º–æ—Ñ–µ–π", "–°–∏–ª—É–∞–Ω"}, {"–ê–≥—Ä–∞—Ñ–µ–Ω–∞", "–ê–≥—Ä–∏–ø–ø–∏–Ω–∞"}),
    (6, 24): ({"–ï—Ñ—Ä–µ–º", "–í–∞—Ä–Ω–∞–≤–∞"}, set()),  # –†–æ–∂–¥–µ—Å—Ç–≤–æ –ò–æ–∞–Ω–Ω–∞ –ö—Ä–µ—Å—Ç–∏—Ç–µ–ª—è
    (6, 25): ({"–û–Ω—É—Ñ—Ä–∏–π", "–ü—ë—Ç—Ä"}, set()),
    (6, 26): ({"–î–∞–≤–∏–¥", "–î–∏–æ–Ω–∏—Å–∏–π"}, set()),
    (6, 27): ({"–ï–ª–∏—Å–µ–π", "–ú–µ—Ñ–æ–¥–∏–π"}, set()),
    (6, 28): ({"–ò–æ–Ω–∞", "–ê–≤–≥—É—Å—Ç–∏–Ω"}, set()),
    (6, 29): ({"–ü—ë—Ç—Ä", "–ü–∞–≤–µ–ª", "–¢–∏—Ö–æ–Ω"}, set()),  # –ü–µ—Ç—Ä–∞ –∏ –ü–∞–≤–ª–∞
    (6, 30): ({"–ú–∞–Ω—É–∏–ª", "–ò–∑–º–∞–∏–ª"}, set()),

    # –ò–Æ–õ–¨
    (7, 1): ({"–õ–µ–æ–Ω—Ç–∏–π", "–§–µ–æ–¥—É–ª"}, set()),
    (7, 2): ({"–ò—É–¥–∞", "–ó–æ—Å–∏–º–∞"}, set()),
    (7, 3): ({"–ì–ª–µ–±", "–ú–µ—Ñ–æ–¥–∏–π"}, {"–†–∏–º–º–∞", "–ò–Ω–Ω–∞"}),
    (7, 4): ({"–ú–∞–∫—Å–∏–º", "–ò—É–ª–∏–∞–Ω"}, set()),
    (7, 5): ({"–ì–∞–ª–∞–∫—Ç–∏–æ–Ω", "–í–∞—Å–∏–ª–∏–π"}, set()),
    (7, 6): ({"–ê—Ä—Ç–µ–º–∏–π", "–ì–µ—Ä–º–∞–Ω"}, set()),
    (7, 7): ({"–Ø–∫–æ–≤", "–ê–Ω—Ç–æ–Ω–∏–π"}, set()),
    (7, 8): ({"–ü—ë—Ç—Ä", "–§–µ–≤—Ä–æ–Ω–∏—è"}, {"–§–µ–≤—Ä–æ–Ω–∏—è"}),
    (7, 9): ({"–î–∞–≤–∏–¥", "–¢–∏—Ö–æ–Ω"}, set()),
    (7, 10): ({"–°–∞–º—Å–æ–Ω", "–°–µ–≤–∏—Ä"}, set()),
    (7, 11): ({"–°–µ—Ä–≥–µ–π", "–ü–∞–≤–µ–ª"}, set()),
    (7, 12): ({"–ü—ë—Ç—Ä", "–ü–∞–≤–µ–ª"}, set()),
    (7, 13): ({"–ê–Ω–¥—Ä–µ–π", "–°–æ—Ñ—Ä–æ–Ω–∏–π"}, set()),
    (7, 14): ({"–ö–æ–∑–º–∞", "–î–∞–º–∏–∞–Ω"}, {"–ê–Ω–≥–µ–ª–∏–Ω–∞"}),
    (7, 15): ({"–§–æ—Ç–∏–π", "–ê–Ω–∏–∫–∏—Ç–∞"}, set()),
    (7, 16): ({"–ê—Ñ–∏–Ω–æ–≥–µ–Ω", "–ü–∞–≤–µ–ª"}, set()),
    (7, 17): ({"–ê–Ω–¥—Ä–µ–π", "–ï—Ñ–∏–º"}, {"–ú–∞—Ä—Ñ–∞", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞"}),
    (7, 18): ({"–°–µ—Ä–≥–µ–π", "–ê—Ñ–∞–Ω–∞—Å–∏–π"}, {"–ï–ª–∏–∑–∞–≤–µ—Ç–∞", "–ê–Ω–Ω–∞"}),
    (7, 19): ({"–°–∏—Å–æ–π", "–°–∏—Å–∏–Ω–∏–π"}, {"–õ—É–∫–∏—è"}),
    (7, 20): ({"–§–æ–º–∞", "–ì–µ—Ä–º–∞–Ω"}, {"–ï–≤—Ñ—Ä–æ—Å–∏–Ω–∏—è", "–ï–≤–¥–æ–∫–∏—è"}),
    (7, 21): ({"–ü—Ä–æ–∫–æ–ø–∏–π", "–î–∞–Ω–∏–∏–ª"}, set()),
    (7, 22): ({"–ü–∞–Ω–∫—Ä–∞—Ç–∏–π", "–§–µ–æ–¥–æ—Ä"}, {"–ú–∞—Ä–∏—è –ú–∞–≥–¥–∞–ª–∏–Ω–∞"}),
    (7, 23): ({"–ê–Ω—Ç–æ–Ω–∏–π", "–ê–ø–æ–ª–ª–æ–Ω–∏–π"}, set()),
    (7, 24): ({"–ë–æ—Ä–∏—Å", "–ì–ª–µ–±"}, set()),  # –ë–æ—Ä–∏—Å–∞ –∏ –ì–ª–µ–±–∞
    (7, 25): ({"–°–∏–º–µ–æ–Ω", "–ü—Ä–æ–∫–ª"}, set()),
    (7, 26): ({"–ì–∞–≤—Ä–∏–∏–ª", "–°—Ç–µ—Ñ–∞–Ω"}, set()),
    (7, 27): ({"–ü–∞–Ω—Ç–µ–ª–µ–π–º–æ–Ω", "–ù–∏–∫–æ–ª–∞–π"}, set()),
    (7, 28): ({"–ö–∏—Ä–∏–ª–ª", "–í–ª–∞–¥–∏–º–∏—Ä"}, {"–ò—É–ª–∏—Ç—Ç–∞"}),  # –ö–Ω—è–∑—è –í–ª–∞–¥–∏–º–∏—Ä–∞
    (7, 29): ({"–ü–∞–≤–µ–ª", "–ö–∞–ª–ª–∏–Ω–∏–∫"}, {"–ú–∞—Ç—Ä–æ–Ω–∞", "–ê–ª–µ–≤—Ç–∏–Ω–∞", "–í–∞–ª–µ–Ω—Ç–∏–Ω–∞"}),
    (7, 30): ({"–ò–æ–∞–Ω–Ω", "–°–∏–ª–∞"}, {"–ú–∞—Ä–∏–Ω–∞", "–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞"}),
    (7, 31): ({"–ï–º–µ–ª—å—è–Ω", "–ì–µ—Ä–º–∞–Ω"}, {"–ï–ª–µ–Ω–∞"}),

    # –ê–í–ì–£–°–¢
    (8, 1): ({"–ú–∞–∫—Ä–∏–Ω–∞", "–†–æ–º–∞–Ω"}, {"–ú–∞–∫—Ä–∏–Ω–∞"}),
    (8, 2): ({"–ò–ª—å—è"}, set()),  # –ò–ª—å–∏–Ω –¥–µ–Ω—å
    (8, 3): ({"–û–Ω—É—Ñ—Ä–∏–π", "–°–∏–º–µ–æ–Ω"}, set()),
    (8, 4): ({"–ú–∞—Ä–∏—è –ú–∞–≥–¥–∞–ª–∏–Ω–∞"}, {"–ú–∞—Ä–∏—è –ú–∞–≥–¥–∞–ª–∏–Ω–∞"}),
    (8, 5): ({"–¢—Ä–æ—Ñ–∏–º", "–§–µ–æ—Ñ–∏–ª"}, set()),
    (8, 6): ({"–ë–æ—Ä–∏—Å", "–ì–ª–µ–±"}, set()),
    (8, 7): ({"–£—Å–ø–µ–Ω–∏–µ –ê–Ω–Ω—ã"}, {"–ê–Ω–Ω–∞", "–û–ª–∏–º–ø–∏–∞–¥–∞"}),
    (8, 8): ({"–ú–æ–∏—Å–µ–π", "–ï—Ä–º–æ–ª–∞–π"}, {"–ü–∞—Ä–∞—Å–∫–µ–≤–∞"}),
    (8, 9): ({"–ü–∞–Ω—Ç–µ–ª–µ–π–º–æ–Ω", "–ù–∏–∫–æ–ª–∞–π"}, set()),
    (8, 10): ({"–ü—Ä–æ—Ö–æ—Ä", "–ù–∏–∫–∞–Ω–æ—Ä"}, {"–ò—Ä–∏–Ω–∞"}),
    (8, 11): ({"–ö–∞–ª–ª–∏–Ω–∏–∫", "–°–µ—Ä–∞—Ñ–∏–º"}, set()),
    (8, 12): ({"–ò–æ–∞–Ω–Ω –í–æ–∏–Ω", "–°–∏–ª—É–∞–Ω"}, set()),
    (8, 13): ({"–¢–∏—Ö–æ–Ω", "–í–µ–Ω–∏–∞–º–∏–Ω"}, set()),
    (8, 14): ({"–ú–∞—Ä–∫–µ–ª–ª", "–ï–≤—Å–µ–≤–∏–π"}, {"–°–æ–ª–æ–º–æ–Ω–∏—è"}),
    (8, 15): ({"–£—Å–ø–µ–Ω–∏–µ"}, {"–ú–∞—Ä–∏—è"}),  # –£—Å–ø–µ–Ω–∏–µ –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã
    (8, 16): ({"–ê–Ω—Ç–æ–Ω–∏–π", "–ò—Å–∞–∞–∫–∏–π"}, set()),
    (8, 17): ({"–ú–∏—Ö–µ–π", "–ê–ª–∏–ø–∏–π"}, set()),
    (8, 18): ({"–ï–≤–¥–æ–∫–∏–º", "–§–ª–æ—Ä"}, {"–ù–æ–Ω–Ω–∞", "–•—Ä–∏—Å—Ç–∏–Ω–∞"}),
    (8, 19): ({"–§–µ–æ–∫—Ç–∏—Å—Ç", "–ê–Ω–¥—Ä–µ–π"}, set()),
    (8, 20): ({"–°–∞–º—É–∏–ª", "–î–æ–º–µ—Ç–∏–π"}, set()),
    (8, 21): ({"–ï–º–µ–ª—å—è–Ω", "–ì—Ä–∏–≥–æ—Ä–∏–π"}, set()),
    (8, 22): ({"–ê–Ω—Ç–æ–Ω–∏–π", "–ò—Ä–∏–Ω–∞"}, {"–ú–∞—Ä–∏—è"}),
    (8, 23): ({"–õ–∞–≤—Ä–µ–Ω—Ç–∏–π", "–†–æ–º–∞–Ω"}, set()),
    (8, 24): ({"–ú–∞–∫—Å–∏–º", "–ï–≤–ø–ª"}, set()),
    (8, 25): ({"–§–æ—Ç–∏–π", "–ê–Ω–∏–∫–∏—Ç–∞"}, set()),
    (8, 26): ({"–ú–∞–∫—Å–∏–º", "–¢–∏—Ö–æ–Ω"}, {"–ö—Å–µ–Ω–∏—è", "–ü–∞—Ä–∞—Å–∫–µ–≤–∞", "–ü—Ä–∞—Å–∫–æ–≤—å—è"}),
    (8, 27): ({"–ú–∏—Ö–µ–π", "–ê—Ä–∫–∞–¥–∏–π"}, set()),
    (8, 28): ({"–£—Å–ø–µ–Ω–∏–µ"}, {"–ú–∞—Ä–∏—è", "–°–æ—Ñ–∏—è"}),
    (8, 29): ({"–£—Å–µ–∫–Ω–æ–≤–µ–Ω–∏–µ"}, set()),  # –ò–æ–∞–Ω–Ω–∞ –ö—Ä–µ—Å—Ç–∏—Ç–µ–ª—è
    (8, 30): ({"–ê–ª–∏–ø–∏–π", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, {"–†–æ–∑–∞", "–°–∞–±–∏–Ω–∞"}),
    (8, 31): ({"–ì–µ–Ω–Ω–∞–¥–∏–π", "–ò–ª–∞—Ä–∏–æ–Ω"}, set()),

    # –°–ï–ù–¢–Ø–ë–†–¨
    (9, 1): ({"–ê–Ω–¥—Ä–µ–π", "–¢–∏–º–æ—Ñ–µ–π"}, {"–§—ë–∫–ª–∞"}),
    (9, 2): ({"–°–∞–º—É–∏–ª", "–§–∏–ª–∏–ø–ø"}, set()),
    (9, 3): ({"–ê–≤—Ä–∞–º–∏–π", "–ü–∏–π"}, {"–ú–∞—Ä—Ñ–∞", "–í–∞—Å—Å–∞"}),
    (9, 4): ({"–ê–≥–∞—Ñ–æ–Ω–∏–∫", "–ì–æ—Ä–∞–∑–¥"}, set()),
    (9, 5): ({"–ï—Ñ—Ä–µ–º", "–ò—Ä–∏–Ω–∞—Ä—Ö"}, set()),
    (9, 6): ({"–ï–≤—Ç–∏—Ö–∏–π", "–ê—Ä—Å–µ–Ω–∏–π"}, set()),
    (9, 7): ({"–í–∞—Ä—Ñ–æ–ª–æ–º–µ–π", "–¢–∏—Ç"}, set()),
    (9, 8): ({"–†–æ–∂–¥–µ—Å—Ç–≤–æ –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã"}, {"–ú–∞—Ä–∏—è", "–ù–∞—Ç–∞–ª–∏—è"}),
    (9, 9): ({"–ú–∏—Ö–∞–∏–ª", "–ü–∏–º–µ–Ω"}, {"–ê–Ω—Ñ–∏—Å–∞"}),
    (9, 10): ({"–ú–æ–∏—Å–µ–π", "–°–∞–≤–≤–∞"}, {"–ê–Ω–Ω–∞", "–°—É—Å–∞–Ω–Ω–∞"}),
    (9, 11): ({"–ò–≤–∞–Ω –ü—Ä–µ–¥—Ç–µ—á–∞"}, set()),
    (9, 12): ({"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ì—Ä–∏–≥–æ—Ä–∏–π"}, set()),
    (9, 13): ({"–ö–∏–ø—Ä–∏–∞–Ω", "–ì–µ–Ω–Ω–∞–¥–∏–π"}, set()),
    (9, 14): ({"–í–æ–∑–¥–≤–∏–∂–µ–Ω–∏–µ"}, {"–ú–∞—Ä—Ñ–∞"}),
    (9, 15): ({"–ù–∏–∫–∏—Ç–∞", "–§–µ–æ–¥–æ—Ç"}, set()),
    (9, 16): ({"–î–æ—Ä–æ—Ñ–µ–π", "–ì–æ—Ä–æ–Ω—Ç–∏–π"}, {"–î–æ–º–Ω–∞", "–í–∞—Å–∏–ª–∏—Å–∞"}),
    (9, 17): ({"–í–µ—Ä–∞, –ù–∞–¥–µ–∂–¥–∞, –õ—é–±–æ–≤—å"}, {"–í–µ—Ä–∞", "–ù–∞–¥–µ–∂–¥–∞", "–õ—é–±–æ–≤—å", "–°–æ—Ñ–∏—è"}),
    (9, 18): ({"–ó–∞—Ö–∞—Ä–∏–π", "–ï–ª–∏–∑–∞–≤–µ—Ç–∞"}, {"–ï–ª–∏–∑–∞–≤–µ—Ç–∞", "–†–∞–∏—Å–∞"}),
    (9, 19): ({"–ú–∏—Ö–∞–∏–ª", "–ê—Ä—Ö–∏–ø"}, set()),
    (9, 20): ({"–ï–≤—Å—Ç–∞—Ñ–∏–π", "–ú–∏—Ö–∞–∏–ª"}, set()),
    (9, 21): ({"–î–∏–º–∏—Ç—Ä–∏–π", "–ò–æ—Å–∏—Ñ"}, set()),
    (9, 22): ({"–ò–æ—Å–∏—Ñ", "–ù–∏–∫–∏—Ç–∞"}, {"–ê–Ω–Ω–∞", "–ú–∞—Ä—Ñ–∞"}),
    (9, 23): ({"–ê–Ω–¥—Ä–µ–π", "–ü–∞–≤–µ–ª"}, set()),
    (9, 24): ({"–î–∏–º–∏—Ç—Ä–∏–π", "–°–µ—Ä–≥–∏–π"}, {"–§–µ–æ–¥–æ—Ä–∞"}),
    (9, 25): ({"–°–µ—Ä–≥–∏–π –†–∞–¥–æ–Ω–µ–∂—Å–∫–∏–π"}, set()),
    (9, 26): ({"–ù–∏–∫–æ–ª–∞–π", "–ò—É–ª–∏–∞–Ω"}, set()),
    (9, 27): ({"–ò–æ–∞–Ω–Ω"}, set()),
    (9, 28): ({"–í—è—á–µ—Å–ª–∞–≤", "–ù–∏–∫–∏—Ç–∞"}, {"–õ—é–¥–º–∏–ª–∞"}),
    (9, 29): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–í–∏–∫—Ç–æ—Ä"}, {"–õ—é–¥–º–∏–ª–∞", "–ú–µ–ª–∏—Ç–∏–Ω–∞"}),
    (9, 30): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–ú–∏—Ö–∞–∏–ª"}, {"–í–µ—Ä–∞", "–ù–∞–¥–µ–∂–¥–∞", "–õ—é–±–æ–≤—å", "–°–æ—Ñ–∏—è"}),

    # –û–ö–¢–Ø–ë–†–¨
    (10, 1): ({"–ü–æ–∫—Ä–æ–≤"}, {"–ò—Ä–∏–Ω–∞", "–°–æ—Ñ–∏—è", "–ê—Ä–∏–∞–¥–Ω–∞"}),
    (10, 2): ({"–ê–ª–µ–∫—Å–∏–π", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω"}, set()),
    (10, 3): ({"–û–ª–µ–≥", "–ú–∏—Ö–∞–∏–ª"}, {"–¢–∞—Ç—å—è–Ω–∞"}),
    (10, 4): ({"–î–∏–º–∏—Ç—Ä–∏–π", "–ö–æ–Ω–¥—Ä–∞—Ç"}, set()),
    (10, 5): ({"–ü—ë—Ç—Ä", "–ú–∞–∫–∞—Ä–∏–π"}, {"–ü—Ä–∞—Å–∫–æ–≤—å—è"}),
    (10, 6): ({"–ò–Ω–Ω–æ–∫–µ–Ω—Ç–∏–π", "–ê–Ω–¥—Ä–æ–Ω–∏–∫"}, {"–ò—Ä–∞–∏–¥–∞"}),
    (10, 7): ({"–°–µ—Ä–≥–∏–π", "–í–∏—Ç–∞–ª–∏–π"}, {"–§—ë–∫–ª–∞"}),
    (10, 8): ({"–°–µ—Ä–≥–µ–π", "–ì–µ—Ä–º–∞–Ω"}, {"–ï—Ñ—Ä–æ—Å–∏–Ω–∏—è"}),
    (10, 9): ({"–ò–≤–∞–Ω", "–í–ª–∞–¥–∏–º–∏—Ä", "–¢–∏—Ö–æ–Ω"}, set()),
    (10, 10): ({"–ú–∞—Ä–∫", "–°–∞–≤–≤–∞—Ç–∏–π"}, set()),
    (10, 11): ({"–í—è—á–µ—Å–ª–∞–≤", "–•–∞—Ä–∏—Ç–æ–Ω"}, {"–ê–Ω–Ω–∞", "–ú–∞—Ä–∏—è"}),
    (10, 12): ({"–§–µ–æ—Ñ–∞–Ω", "–ö–∏—Ä–∏–∞–∫"}, set()),
    (10, 13): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–ú–∏—Ö–∞–∏–ª"}, set()),
    (10, 14): ({"–†–æ–º–∞–Ω", "–°–∞–≤–≤–∞"}, set()),
    (10, 15): ({"–ö–∏–ø—Ä–∏–∞–Ω", "–ê–Ω–¥—Ä–µ–π"}, {"–£—Å—Ç–∏–Ω—å—è"}),
    (10, 16): ({"–î–µ–Ω–∏—Å", "–î–∏–æ–Ω–∏—Å–∏–π"}, set()),
    (10, 17): ({"–ï—Ä–æ—Ñ–µ–π", "–î–∏–º–∏—Ç—Ä–∏–π"}, set()),
    (10, 18): ({"–ê–ª–µ–∫—Å–∏–π", "–ü—ë—Ç—Ä"}, set()),
    (10, 19): ({"–§–æ–º–∞", "–ò–æ–∞–Ω–Ω"}, set()),
    (10, 20): ({"–°–µ—Ä–≥–µ–π", "–ù–∏–∫–æ–ª–∞–π"}, {"–ü–µ–ª–∞–≥–µ—è"}),
    (10, 21): ({"–¢—Ä–∏—Ñ–æ–Ω", "–î–º–∏—Ç—Ä–∏–π"}, {"–ü–µ–ª–∞–≥–µ—è", "–¢–∞–∏—Å–∏—è"}),
    (10, 22): ({"–Ø–∫–æ–≤", "–ü—ë—Ç—Ä"}, {"–ù–∞–¥–µ–∂–¥–∞"}),
    (10, 23): ({"–ê–Ω–¥—Ä–µ–π", "–ï–≤–ª–∞–º–ø–∏–π"}, set()),
    (10, 24): ({"–§–∏–ª–∏–ø–ø", "–§–µ–æ—Ñ–∞–Ω"}, {"–ó–∏–Ω–∞–∏–¥–∞"}),
    (10, 25): ({"–ü—Ä–æ–≤", "–ö–æ—Å–º–∞"}, {"–î–æ–º–∏–Ω–∏–∫–∞"}),
    (10, 26): ({"–ù–∏–∫–∏—Ç–∞", "–ó–ª–∞—Ç–æ—É—Å—Ç"}, {"–ó–ª–∞—Ç–∞"}),
    (10, 27): ({"–ù–∏–∫–æ–ª–∞–π"}, {"–ü–∞—Ä–∞—Å–∫–µ–≤–∞", "–ü—Ä–∞—Å–∫–æ–≤—å—è"}),
    (10, 28): ({"–ï–≤—Ñ–∏–º–∏–π", "–ò–≤–∞–Ω"}, {"–ï—Ñ—Ä–æ—Å–∏–Ω–∏—è"}),
    (10, 29): ({"–¢–µ—Ä–µ–Ω—Ç–∏–π", "–õ–æ–Ω–≥–∏–Ω"}, set()),
    (10, 30): ({"–ö–æ–∑–º–∞", "–î–∞–º–∏–∞–Ω"}, set()),
    (10, 31): ({"–õ—É–∫–∞", "–ò–æ—Å–∏—Ñ"}, set()),

    # –ù–û–Ø–ë–†–¨
    (11, 1): ({"–ò–≤–∞–Ω", "–°–µ—Ä–≥–∏–π"}, set()),
    (11, 2): ({"–ê—Ä—Ç–µ–º–∏–π", "–ì–µ—Ä–∞—Å–∏–º"}, set()),
    (11, 3): ({"–ò–ª–ª–∞—Ä–∏–æ–Ω", "–î–∏–º–∏—Ç—Ä–∏–π"}, {"–ü–µ–ª–∞–≥–µ—è"}),
    (11, 4): ({"–ö–∞–∑–∞–Ω—Å–∫–∞—è"}, {"–ï–ª–∏–∑–∞–≤–µ—Ç–∞"}),
    (11, 5): ({"–Ø–∫–æ–≤", "–ò–≥–Ω–∞—Ç–∏–π"}, set()),
    (11, 6): ({"–ê—Ñ–∞–Ω–∞—Å–∏–π", "–ê—Ä–µ—Ñ–∞"}, set()),
    (11, 7): ({"–ú–∞—Ä–∫–∏–∞–Ω", "–ú–∞—Ä—Ç–∏—Ä–∏–π"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (11, 8): ({"–î–∏–º–∏—Ç—Ä–∏–π –°–æ–ª—É–Ω—Å–∫–∏–π"}, set()),
    (11, 9): ({"–ú–∞—Ä–∫", "–ù–µ—Å—Ç–æ—Ä"}, {"–ö–∞–ø–∏—Ç–æ–ª–∏–Ω–∞"}),
    (11, 10): ({"–ê—Ä—Å–µ–Ω–∏–π", "–¢–µ—Ä–µ–Ω—Ç–∏–π"}, {"–ù–µ–æ–Ω–∏–ª–∞", "–ü–∞—Ä–∞—Å–∫–µ–≤–∞"}),
    (11, 11): ({"–ê–≤—Ä–∞–º–∏–π", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}, {"–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ú–∞—Ä–∏—è"}),
    (11, 12): ({"–ó–∏–Ω–æ–≤–∏–π", "–ò–æ–∞–Ω–Ω"}, {"–ó–∏–Ω–∞–∏–¥–∞", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è"}),
    (11, 13): ({"–ù–∏–∫–æ–¥–∏–º", "–°–ø–∏—Ä–∏–¥–æ–Ω"}, set()),
    (11, 14): ({"–ö–æ–∑–º–∞", "–î–∞–º–∏–∞–Ω"}, set()),
    (11, 15): ({"–®—É–π—Å–∫–∞—è"}, set()),
    (11, 16): ({"–ì–µ–æ—Ä–≥–∏–π", "–ê–∫–µ–ø—Å–∏–º"}, set()),
    (11, 17): ({"–ù–∏–∫–∞–Ω–¥—Ä", "–ì—Ä–∏–≥–æ—Ä–∏–π"}, set()),
    (11, 18): ({"–ì–∞–ª–∞–∫—Ç–∏–æ–Ω", "–ò–æ–Ω–∞"}, set()),
    (11, 19): ({"–ü–∞–≤–µ–ª", "–í–∞—Ä–ª–∞–∞–º"}, set()),
    (11, 20): ({"–ö–∏—Ä–∏–ª–ª", "–§–µ–æ–¥–æ—Ç"}, set()),
    (11, 21): ({"–ú–∏—Ö–∞–∏–ª –ê—Ä—Ö–∞–Ω–≥–µ–ª"}, set()),  # –ú–∏—Ö–∞–π–ª–æ–≤ –¥–µ–Ω—å
    (11, 22): ({"–ú–∞—Ç—Ä–æ–Ω–∞", "–ù–µ–∫—Ç–∞—Ä–∏–π"}, {"–ú–∞—Ç—Ä–æ–Ω–∞", "–ú–∞—Ç—Ä—ë–Ω–∞"}),
    (11, 23): ({"–û—Ä–µ—Å—Ç", "–†–æ–¥–∏–æ–Ω"}, set()),
    (11, 24): ({"–§–µ–æ–¥–æ—Ä", "–ú–∞–∫—Å–∏–º"}, {"–°—Ç–µ–ø–∞–Ω–∏–¥–∞"}),
    (11, 25): ({"–ò–≤–∞–Ω –ú–∏–ª–æ—Å—Ç–∏–≤—ã–π"}, set()),
    (11, 26): ({"–ò–æ–∞–Ω–Ω –ó–ª–∞—Ç–æ—É—Å—Ç"}, set()),
    (11, 27): ({"–§–∏–ª–∏–ø–ø", "–ì—Ä–∏–≥–æ—Ä–∏–π"}, set()),
    (11, 28): ({"–ì—É—Ä–∏–π", "–°–∞–º–æ–Ω"}, set()),
    (11, 29): ({"–ú–∞—Ç–≤–µ–π", "–§—ë–¥–æ—Ä"}, set()),
    (11, 30): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–ù–∏–∫–æ–Ω"}, set()),

    # –î–ï–ö–ê–ë–†–¨
    (12, 1): ({"–ü–ª–∞—Ç–æ–Ω", "–†–æ–º–∞–Ω"}, set()),
    (12, 2): ({"–ê–≤–∏–≤", "–§–∏–ª–∞—Ä–µ—Ç"}, set()),
    (12, 3): ({"–ì—Ä–∏–≥–æ—Ä–∏–π", "–ü—Ä–æ–∫–ª"}, {"–ê–Ω–Ω–∞"}),
    (12, 4): ({"–ê–ª–µ–∫—Å–µ–π", "–ò–≤–∞–Ω"}, {"–í–∞—Ä–≤–∞—Ä–∞"}),
    (12, 5): ({"–ü—Ä–æ–∫–æ–ø–∏–π", "–°–∞–≤–≤–∞"}, {"–ü—Ä–∞—Å–∫–æ–≤—å—è"}),
    (12, 6): ({"–ú–∏—Ç—Ä–æ—Ñ–∞–Ω", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä"}, set()),
    (12, 7): ({"–ê–º–≤—Ä–æ—Å–∏–π", "–ì—Ä–∏–≥–æ—Ä–∏–π"}, {"–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞"}),
    (12, 8): ({"–ö–ª–∏–º–µ–Ω—Ç", "–ü—ë—Ç—Ä"}, set()),
    (12, 9): ({"–ì–µ–æ—Ä–≥–∏–π", "–ò–Ω–Ω–æ–∫–µ–Ω—Ç–∏–π"}, set()),
    (12, 10): ({"–ò–∞–∫–æ–≤", "–ü–∞–ª–ª–∞–¥–∏–π"}, set()),
    (12, 11): ({"–î–∞–Ω–∏–∏–ª", "–ù–∏–∫–æ–Ω"}, set()),
    (12, 12): ({"–°–ø–∏—Ä–∏–¥–æ–Ω", "–ü–∞—Ä–∞–º–æ–Ω"}, set()),
    (12, 13): ({"–ê–Ω–¥—Ä–µ–π", "–õ—É–∫–∏—è"}, {"–õ—É–∫–∏—è"}),
    (12, 14): ({"–ù–∞—É–º", "–§–∏–ª–∞—Ä–µ—Ç"}, set()),
    (12, 15): ({"–ê–≤–≤–∞–∫—É–º", "–î–∞–º–∞—Å–∫–∏–Ω"}, set()),
    (12, 16): ({"–°–æ—Ñ–æ–Ω–∏—è", "–ò–æ–∞–Ω–Ω"}, set()),
    (12, 17): ({"–î–∏–º–∏—Ç—Ä–∏–π", "–ù–∏–∫–æ–ª–∞–π"}, {"–í–∞—Ä–≤–∞—Ä–∞"}),
    (12, 18): ({"–°–∞–≤–≤–∞", "–ì–µ–Ω–Ω–∞–¥–∏–π"}, set()),
    (12, 19): ({"–ù–∏–∫–æ–ª–∞–π –ß—É–¥–æ—Ç–≤–æ—Ä–µ—Ü"}, set()),  # –ù–∏–∫–æ–ª–∞ –ó–∏–º–Ω–∏–π
    (12, 20): ({"–ê–º–≤—Ä–æ—Å–∏–π", "–ê–Ω—Ç–æ–Ω–∏–π"}, set()),
    (12, 21): ({"–ê–Ω—Ñ–∏–º", "–ö–∏—Ä–∏–ª–ª"}, {"–ê–Ω—Ñ–∏—Å–∞"}),
    (12, 22): ({"–ê–Ω–Ω–∞"}, {"–ê–Ω–Ω–∞"}),  # –ó–∞—á–∞—Ç–∏–µ –ê–Ω–Ω—ã
    (12, 23): ({"–ï–≤–≥–µ–Ω–∏–π", "–ò–æ–∞–Ω–Ω"}, set()),
    (12, 24): ({"–î–∞–Ω–∏–∏–ª", "–õ—É–∫–∞"}, set()),
    (12, 25): ({"–†–æ–∂–¥–µ—Å—Ç–≤–æ"}, {"–ï–≤–≥–µ–Ω–∏—è"}),  # –†–æ–∂–¥–µ—Å—Ç–≤–æ –•—Ä–∏—Å—Ç–æ–≤–æ
    (12, 26): ({"–ï–≤–≥–µ–Ω–∏–π", "–ï–≤—Å—Ç—Ä–∞—Ç–∏–π"}, set()),
    (12, 27): ({"–°—Ç–µ—Ñ–∞–Ω", "–§–µ–æ–¥–æ—Ä"}, set()),
    (12, 28): ({"–ò–æ–∞–Ω–Ω", "–°–∏–º–µ–æ–Ω"}, set()),
    (12, 29): ({"–ê–≥–≥–µ–π"}, set()),
    (12, 30): ({"–î–∞–Ω–∏–∏–ª", "–ê–Ω–∞–Ω–∏—è"}, set()),
    (12, 31): ({"–ú–æ–¥–µ—Å—Ç", "–°–µ–≤–∞—Å—Ç–∏–∞–Ω"}, set()),
}

# –í–∞—Ä–∏–∞—Ü–∏–∏ –∏–º—ë–Ω (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
NAME_VARIANTS = {
    # –ú—É–∂—Å–∫–∏–µ
    "–ò–æ–∞–Ω–Ω": "–ò–≤–∞–Ω", "–ò–æ–∞–Ω": "–ò–≤–∞–Ω", "–ô–æ–∞–Ω": "–ò–≤–∞–Ω",
    "–ü—ë—Ç—Ä": "–ü—ë—Ç—Ä", "–ü–µ—Ç—Ä": "–ü—ë—Ç—Ä",
    "–§—ë–¥–æ—Ä": "–§—ë–¥–æ—Ä", "–§–µ–¥–æ—Ä": "–§—ë–¥–æ—Ä", "–§–µ–æ–¥–æ—Ä": "–§—ë–¥–æ—Ä",
    "–°—Ç–µ—Ñ–∞–Ω": "–°—Ç–µ–ø–∞–Ω", "–°—Ç–µ—Ñ–∞–Ω": "–°—Ç–µ–ø–∞–Ω",
    "–ì–µ–æ—Ä–≥–∏–π": "–ì–µ–æ—Ä–≥–∏–π", "–ï–≥–æ—Ä": "–ì–µ–æ—Ä–≥–∏–π", "–Æ—Ä–∏–π": "–ì–µ–æ—Ä–≥–∏–π",
    "–ï–≤—Ñ–∏–º–∏–π": "–ï—Ñ–∏–º", "–ï—Ñ–∏–º–∏–π": "–ï—Ñ–∏–º",
    "–ò–∞–∫–æ–≤": "–Ø–∫–æ–≤", "–ò–∞–∫–æ–≤": "–Ø–∫–æ–≤",
    "–ö–æ–∑—å–º–∞": "–ö—É–∑—å–º–∞", "–ö–æ—Å–º–∞": "–ö—É–∑—å–º–∞",
    "–°–∏–º–µ–æ–Ω": "–°–µ–º—ë–Ω", "–°–∏–º–æ–Ω": "–°–µ–º—ë–Ω",
    "–î–∏–º–∏—Ç—Ä–∏–π": "–î–º–∏—Ç—Ä–∏–π",
    "–ù–∏–∫–æ–ª–∞–π": "–ù–∏–∫–æ–ª–∞–π", "–ù–∏–∫–æ–ª–∞": "–ù–∏–∫–æ–ª–∞–π",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–ª–µ–∫—Å–µ–π": "–ê–ª–µ–∫—Å–µ–π",
    "–¢–µ—Ä–µ–Ω—Ç–∏–π": "–¢–µ—Ä–µ–Ω—Ç–∏–π", "–¢–µ—Ä–µ–Ω—Ü–∏–π": "–¢–µ—Ä–µ–Ω—Ç–∏–π",
    "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω": "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–ö–æ—Å—Ç–µ–Ω—Ç–∏–Ω": "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω",
    "–ï–≤—Å—Ç–∞—Ñ–∏–π": "–ï–≤—Å—Ç–∞—Ñ–∏–π", "–û—Å—Ç–∞—Ñ–∏–π": "–ï–≤—Å—Ç–∞—Ñ–∏–π", "–ê—Å—Ç–∞—Ñ–∏–π": "–ï–≤—Å—Ç–∞—Ñ–∏–π",
    "–õ–µ–æ–Ω—Ç–∏–π": "–õ–µ–æ–Ω—Ç–∏–π", "–õ–µ–æ–Ω–∏–¥": "–õ–µ–æ–Ω—Ç–∏–π",
    "–í–∞—Å–∏–ª–∏–π": "–í–∞—Å–∏–ª–∏–π", "–í–∞—Å–∏–ª": "–í–∞—Å–∏–ª–∏–π",
    "–ò–ª–∞—Ä–∏–æ–Ω": "–ò–ª–ª–∞—Ä–∏–æ–Ω", "–õ–∞—Ä–∏–æ–Ω": "–ò–ª–ª–∞—Ä–∏–æ–Ω",
    "–ì–∞–≤—Ä–∏–ª": "–ì–∞–≤—Ä–∏–∏–ª", "–ì–∞–≤—Ä–∏–∏–ª": "–ì–∞–≤—Ä–∏–∏–ª",
    "–ú–∏—Ö–∞–∏–ª": "–ú–∏—Ö–∞–∏–ª", "–ú–∏—Ö–∞–π–ª–æ": "–ú–∏—Ö–∞–∏–ª",
    "–î–∞–Ω–∏–∏–ª": "–î–∞–Ω–∏–∏–ª", "–î–∞–Ω–∏–ª": "–î–∞–Ω–∏–∏–ª", "–î–∞–Ω–∏–ª–∞": "–î–∞–Ω–∏–∏–ª",
    # –ñ–µ–Ω—Å–∫–∏–µ
    "–ï–≤–¥–æ–∫–∏—è": "–ï–≤–¥–æ–∫–∏—è", "–ê–≤–¥–æ—Ç—å—è": "–ï–≤–¥–æ–∫–∏—è",
    "–ü–∞—Ä–∞—Å–∫–µ–≤–∞": "–ü—Ä–∞—Å–∫–æ–≤—å—è", "–ü–∞—Ä–∞—Å–∫–æ–≤—å—è": "–ü—Ä–∞—Å–∫–æ–≤—å—è", "–ü–∞—Ä–∞—Å–∫–µ–µ–≤–∞": "–ü—Ä–∞—Å–∫–æ–≤—å—è",
    "–ü–µ—Ä–∞—Å–∫–µ–≤–∞": "–ü—Ä–∞—Å–∫–æ–≤—å—è", "–ü–∞—Ä–∞—Å–∫–µ–≤—å—è": "–ü—Ä–∞—Å–∫–æ–≤—å—è",
    "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞": "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–ö–∞—Ç–µ—Ä–∏–Ω–∞": "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
    "–ö—Å–µ–Ω–∏—è": "–ö—Å–µ–Ω–∏—è", "–ê–∫—Å–∏–Ω—å—è": "–ö—Å–µ–Ω–∏—è", "–û–∫—Å–∞–Ω–∞": "–ö—Å–µ–Ω–∏—è",
    "–ü–µ–ª–∞–≥–µ—è": "–ü–µ–ª–∞–≥–µ—è", "–ü–µ–ª–∞–≥–∏—è": "–ü–µ–ª–∞–≥–µ—è",
    "–î–∞—Ä–∏—è": "–î–∞—Ä—å—è", "–î–∞—Ä—å—è": "–î–∞—Ä—å—è",
    "–ù–∞—Ç–∞–ª–∏—è": "–ù–∞—Ç–∞–ª—å—è", "–ù–∞—Ç–∞–ª—å–∞": "–ù–∞—Ç–∞–ª—å—è",
    "–ú–∞—Ä–∏—è": "–ú–∞—Ä–∏—è", "–ú–∞—Ä—å—è": "–ú–∞—Ä–∏—è", "–ú–∞—Ä–µ—è": "–ú–∞—Ä–∏—è",
    "–ê–Ω–Ω–∞": "–ê–Ω–Ω–∞", "–ê–Ω–∏—Å—å—è": "–ê–Ω–Ω–∞",
    "–¢–∞—Ç–∏–∞–Ω–∞": "–¢–∞—Ç—å—è–Ω–∞", "–¢–∞—Ç–∏—è–Ω–∞": "–¢–∞—Ç—å—è–Ω–∞",
    "–ê–≥—Ä–∏–ø–ø–∏–Ω–∞": "–ê–≥—Ä–∏–ø–ø–∏–Ω–∞", "–ê–≥—Ä–∞—Ñ–µ–Ω–∞": "–ê–≥—Ä–∏–ø–ø–∏–Ω–∞",
    "–ï–≤—Ñ—Ä–æ—Å–∏–Ω–∏—è": "–ï—Ñ—Ä–æ—Å–∏–Ω—å—è", "–ï—Ñ—Ä–æ—Å–∏–Ω—å—è": "–ï—Ñ—Ä–æ—Å–∏–Ω—å—è",
    "–§–µ–æ–¥–æ—Å–∏—è": "–§–µ–æ–¥–æ—Å–∏—è", "–§–µ–¥–æ—Å—å—è": "–§–µ–æ–¥–æ—Å–∏—è",
    "–ò—É–ª–∏–∞–Ω–∏—è": "–£–ª—å—è–Ω–∞", "–£–ª—å—è–Ω–∞": "–£–ª—å—è–Ω–∞", "–Æ–ª–∏–∞–Ω–∞": "–£–ª—å—è–Ω–∞",
    "–•—Ä–∏—Å—Ç–∏–Ω–∞": "–•—Ä–∏—Å—Ç–∏–Ω–∞", "–ö—Ä–∏—Å—Ç–∏–Ω–∞": "–•—Ä–∏—Å—Ç–∏–Ω–∞",
    "–ú–∞—Ç—Ä–æ–Ω–∞": "–ú–∞—Ç—Ä—ë–Ω–∞", "–ú–∞—Ç—Ä—ë–Ω–∞": "–ú–∞—Ç—Ä—ë–Ω–∞", "–ú–∞—Ç—Ä–µ–Ω–∞": "–ú–∞—Ç—Ä—ë–Ω–∞",
    "–ï–ª–∏—Å–∞–≤–µ—Ç–∞": "–ï–ª–∏–∑–∞–≤–µ—Ç–∞", "–ï–ª–∏–∑–∞–≤–µ—Ç–∞": "–ï–ª–∏–∑–∞–≤–µ—Ç–∞",
}


@dataclass
class Person:
    id: str
    name: str
    given_name: str
    surname: str = ""
    sex: str = ""
    birth_date: Optional[date] = None
    birth_year: Optional[int] = None
    death_date: Optional[date] = None
    christening_date: Optional[date] = None
    christening_date_raw: str = ""
    is_julian: bool = False
    famc: Optional[str] = None  # –°–µ–º—å—è –≥–¥–µ —Ä–µ–±—ë–Ω–æ–∫
    fams: List[str] = field(default_factory=list)  # –°–µ–º—å–∏ –≥–¥–µ —Å—É–ø—Ä—É–≥
    godparents: List[str] = field(default_factory=list)  # –ö—Ä—ë—Å—Ç–Ω—ã–µ


@dataclass
class Family:
    id: str
    husband_id: Optional[str] = None
    wife_id: Optional[str] = None
    children_ids: List[str] = field(default_factory=list)
    marriage_date: Optional[date] = None


def normalize_name(name: str) -> str:
    """–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è."""
    name = name.strip()
    # –£–±–∏—Ä–∞–µ–º —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (?, !, —Å–∫–æ–±–∫–∏ –∏ —Ç.–¥.)
    name = re.sub(r'[?\!\(\)\[\]]', '', name).strip()
    # –ü–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è
    if name:
        name = name[0].upper() + name[1:].lower() if len(name) > 1 else name.upper()
    # –ó–∞–º–µ–Ω–∞ –µ –Ω–∞ —ë –≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω–∞—Ö
    name_with_yo = {
        "–ü–µ—Ç—Ä": "–ü—ë—Ç—Ä",
        "–§–µ–¥–æ—Ä": "–§—ë–¥–æ—Ä",
        "–°–µ–º–µ–Ω": "–°–µ–º—ë–Ω",
        "–ê—Ä—Ç–µ–º": "–ê—Ä—Ç—ë–º",
        "–ú–∞—Ç—Ä–µ–Ω–∞": "–ú–∞—Ç—Ä—ë–Ω–∞",
        "–ê–ª–µ–Ω–∞": "–ê–ª—ë–Ω–∞",
    }
    name = name_with_yo.get(name, name)
    return NAME_VARIANTS.get(name, name)


def parse_gedcom_date(date_str: str) -> Tuple[Optional[date], bool, str]:
    """–ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã –∏–∑ GEDCOM —Ñ–æ—Ä–º–∞—Ç–∞."""
    if not date_str:
        return None, False, ""

    date_str = date_str.strip()
    is_julian = "@#DJULIAN@" in date_str
    clean_str = date_str.replace("@#DJULIAN@", "").strip()

    # –£–±–∏—Ä–∞–µ–º –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    for prefix in ["ABT", "BEF", "AFT", "EST", "CAL"]:
        clean_str = clean_str.replace(prefix, "").strip()

    months = {
        'JAN': 1, 'FEB': 2, 'MAR': 3, 'APR': 4, 'MAY': 5, 'JUN': 6,
        'JUL': 7, 'AUG': 8, 'SEP': 9, 'OCT': 10, 'NOV': 11, 'DEC': 12
    }

    # –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞: "15 MAY 1893"
    match = re.match(r'(\d{1,2})\s+([A-Z]{3})\s+(\d{4})', clean_str)
    if match:
        day, month_str, year = match.groups()
        if month_str in months:
            try:
                return date(int(year), months[month_str], int(day)), is_julian, date_str
            except ValueError:
                pass

    return None, is_julian, date_str


def get_saints_for_date(d: date, window: int = 0) -> Tuple[Set[str], Set[str]]:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º—ë–Ω —Å–≤—è—Ç—ã—Ö –¥–ª—è –¥–∞—Ç—ã (–∏ –æ–∫–Ω–∞ –≤–æ–∫—Ä—É–≥ –Ω–µ—ë).
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (–º—É–∂—Å–∫–∏–µ –∏–º–µ–Ω–∞, –∂–µ–Ω—Å–∫–∏–µ –∏–º–µ–Ω–∞).
    """
    male_names = set()
    female_names = set()

    for offset in range(-window, window + 1):
        check_date = d + timedelta(days=offset)
        key = (check_date.month, check_date.day)
        if key in SAINTS_CALENDAR:
            m, f = SAINTS_CALENDAR[key]
            male_names.update(m)
            female_names.update(f)

    return male_names, female_names


def parse_gedcom_full(filepath: str) -> Tuple[Dict[str, Person], Dict[str, Family]]:
    """–ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ GEDCOM —Ñ–∞–π–ª–∞ —Å —Å–µ–º–µ–π–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏."""
    with open(filepath, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    persons: Dict[str, Person] = {}
    families: Dict[str, Family] = {}

    current_type = None
    current_id = None
    current_data: Dict = {}
    in_birt = False
    in_chr = False
    in_deat = False
    in_asso = False
    asso_id = None

    for line in lines:
        line = line.strip()
        if not line:
            continue

        # –£—Ä–æ–≤–µ–Ω—å 0 - –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å
        if line.startswith("0 "):
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∑–∞–ø–∏—Å—å
            if current_type == "INDI" and current_id:
                persons[current_id] = Person(
                    id=current_id,
                    name=current_data.get('name', ''),
                    given_name=current_data.get('givn', ''),
                    surname=current_data.get('surn', ''),
                    sex=current_data.get('sex', ''),
                    birth_date=current_data.get('birth_date'),
                    birth_year=current_data.get('birth_year'),
                    death_date=current_data.get('death_date'),
                    christening_date=current_data.get('chr_date'),
                    christening_date_raw=current_data.get('chr_raw', ''),
                    is_julian=current_data.get('is_julian', False),
                    famc=current_data.get('famc'),
                    fams=current_data.get('fams', []),
                    godparents=current_data.get('godparents', [])
                )
            elif current_type == "FAM" and current_id:
                families[current_id] = Family(
                    id=current_id,
                    husband_id=current_data.get('husb'),
                    wife_id=current_data.get('wife'),
                    children_ids=current_data.get('children', []),
                    marriage_date=current_data.get('marr_date')
                )

            current_data = {'fams': [], 'children': [], 'godparents': []}
            in_birt = in_chr = in_deat = in_asso = False

            match = re.match(r'0 (@\w+@) (\w+)', line)
            if match:
                current_id = match.group(1)
                tag = match.group(2)
                current_type = tag if tag in ('INDI', 'FAM') else None
            else:
                current_type = None
                current_id = None
            continue

        if not current_id:
            continue

        # –£—Ä–æ–≤–µ–Ω—å 1
        if line.startswith("1 "):
            in_birt = in_chr = in_deat = in_asso = False
            parts = line[2:].split(None, 1)
            tag = parts[0]
            value = parts[1] if len(parts) > 1 else ""

            if current_type == "INDI":
                if tag == "NAME":
                    current_data['name'] = value.replace('/', '').strip()
                elif tag == "SEX":
                    current_data['sex'] = value
                elif tag == "BIRT":
                    in_birt = True
                elif tag == "CHR":
                    in_chr = True
                elif tag == "DEAT":
                    in_deat = True
                elif tag == "FAMC":
                    current_data['famc'] = value
                elif tag == "FAMS":
                    current_data['fams'].append(value)
                elif tag == "ASSO":
                    in_asso = True
                    asso_id = value
            elif current_type == "FAM":
                if tag == "HUSB":
                    current_data['husb'] = value
                elif tag == "WIFE":
                    current_data['wife'] = value
                elif tag == "CHIL":
                    current_data['children'].append(value)

        # –£—Ä–æ–≤–µ–Ω—å 2
        elif line.startswith("2 "):
            parts = line[2:].split(None, 1)
            tag = parts[0]
            value = parts[1] if len(parts) > 1 else ""

            if current_type == "INDI":
                if tag == "GIVN":
                    # –ë–µ—Ä—ë–º –ø–µ—Ä–≤–æ–µ –∏–º—è
                    given = value.strip().split()[0] if value.strip() else ""
                    current_data['givn'] = given
                elif tag == "SURN":
                    current_data['surn'] = value.strip()
                elif tag == "DATE":
                    parsed, is_julian, raw = parse_gedcom_date(value)
                    if in_birt:
                        current_data['birth_date'] = parsed
                        if parsed:
                            current_data['birth_year'] = parsed.year
                        else:
                            year_match = re.search(r'(\d{4})', value)
                            if year_match:
                                current_data['birth_year'] = int(year_match.group(1))
                    elif in_chr:
                        current_data['chr_date'] = parsed
                        current_data['chr_raw'] = raw
                        current_data['is_julian'] = is_julian
                    elif in_deat:
                        current_data['death_date'] = parsed
                elif tag == "RELA" and in_asso:
                    if "godp" in value.lower() or "–∫—Ä—ë—Å—Ç–Ω" in value.lower() or "–∫—Ä–µ—Å–Ω" in value.lower():
                        if asso_id:
                            current_data['godparents'].append(asso_id)

    # –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å
    if current_type == "INDI" and current_id:
        persons[current_id] = Person(
            id=current_id,
            name=current_data.get('name', ''),
            given_name=current_data.get('givn', ''),
            surname=current_data.get('surn', ''),
            sex=current_data.get('sex', ''),
            birth_date=current_data.get('birth_date'),
            birth_year=current_data.get('birth_year'),
            death_date=current_data.get('death_date'),
            christening_date=current_data.get('chr_date'),
            christening_date_raw=current_data.get('chr_raw', ''),
            is_julian=current_data.get('is_julian', False),
            famc=current_data.get('famc'),
            fams=current_data.get('fams', []),
            godparents=current_data.get('godparents', [])
        )
    elif current_type == "FAM" and current_id:
        families[current_id] = Family(
            id=current_id,
            husband_id=current_data.get('husb'),
            wife_id=current_data.get('wife'),
            children_ids=current_data.get('children', []),
            marriage_date=current_data.get('marr_date')
        )

    return persons, families


def find_relatives(person: Person, persons: Dict[str, Person], families: Dict[str, Family]) -> Dict[str, List[Person]]:
    """
    –ù–∞–π—Ç–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ —á–µ–ª–æ–≤–µ–∫–∞.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å: —Ç–∏–ø —Ä–æ–¥—Å—Ç–≤–∞ -> —Å–ø–∏—Å–æ–∫ –ø–µ—Ä—Å–æ–Ω
    """
    relatives: Dict[str, List[Person]] = {
        '—Ä–æ–¥–∏—Ç–µ–ª–∏': [],
        '–±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏': [],
        '–∫—Ä—ë—Å—Ç–Ω—ã–µ': [],
        '—Ç—ë—Ç–∏/–¥—è–¥–∏': [],
        '—Å—Ç–∞—Ä—à–∏–µ –±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã': [],
    }

    # –†–æ–¥–∏—Ç–µ–ª–∏
    if person.famc and person.famc in families:
        family = families[person.famc]
        if family.husband_id and family.husband_id in persons:
            relatives['—Ä–æ–¥–∏—Ç–µ–ª–∏'].append(persons[family.husband_id])
        if family.wife_id and family.wife_id in persons:
            relatives['—Ä–æ–¥–∏—Ç–µ–ª–∏'].append(persons[family.wife_id])

        # –ë–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏ (—Ä–æ–¥–∏—Ç–µ–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª–µ–π)
        for parent in relatives['—Ä–æ–¥–∏—Ç–µ–ª–∏']:
            if parent.famc and parent.famc in families:
                gp_family = families[parent.famc]
                if gp_family.husband_id and gp_family.husband_id in persons:
                    relatives['–±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏'].append(persons[gp_family.husband_id])
                if gp_family.wife_id and gp_family.wife_id in persons:
                    relatives['–±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏'].append(persons[gp_family.wife_id])

                # –¢—ë—Ç–∏/–¥—è–¥–∏ (–±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã —Ä–æ–¥–∏—Ç–µ–ª–µ–π)
                for sibling_id in gp_family.children_ids:
                    if sibling_id != parent.id and sibling_id in persons:
                        relatives['—Ç—ë—Ç–∏/–¥—è–¥–∏'].append(persons[sibling_id])

        # –°—Ç–∞—Ä—à–∏–µ –±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã
        for sibling_id in family.children_ids:
            if sibling_id != person.id and sibling_id in persons:
                sibling = persons[sibling_id]
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å—Ç–∞—Ä—à–µ
                if person.birth_year and sibling.birth_year:
                    if sibling.birth_year < person.birth_year:
                        relatives['—Å—Ç–∞—Ä—à–∏–µ –±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã'].append(sibling)
                elif person.birth_date and sibling.birth_date:
                    if sibling.birth_date < person.birth_date:
                        relatives['—Å—Ç–∞—Ä—à–∏–µ –±—Ä–∞—Ç—å—è/—Å—ë—Å—Ç—Ä—ã'].append(sibling)

    # –ö—Ä—ë—Å—Ç–Ω—ã–µ
    for gp_id in person.godparents:
        if gp_id in persons:
            relatives['–∫—Ä—ë—Å—Ç–Ω—ã–µ'].append(persons[gp_id])

    return relatives


def find_namesakes(person: Person, relatives: Dict[str, List[Person]]) -> List[Tuple[str, Person]]:
    """
    –ù–∞–π—Ç–∏ —Ç—ë–∑–æ–∫ —Å—Ä–µ–¥–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ (—Ç–∏–ø —Ä–æ–¥—Å—Ç–≤–∞, –ø–µ—Ä—Å–æ–Ω–∞).
    """
    namesakes = []
    person_name = normalize_name(person.given_name)

    for relation_type, rel_list in relatives.items():
        for rel in rel_list:
            rel_name = normalize_name(rel.given_name)
            if person_name == rel_name:
                namesakes.append((relation_type, rel))

    return namesakes


def analyze_namedays(persons: Dict[str, Person], families: Dict[str, Family], window: int = 8) -> None:
    """–ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏–º—ë–Ω –¥–Ω—è–º –∫—Ä–µ—â–µ–Ω–∏—è —Å –ø–æ–∏—Å–∫–æ–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤-—Ç—ë–∑–æ–∫."""

    matches = []
    mismatches = []

    # –§–∏–ª—å—Ç—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω —Å –¥–∞—Ç–∞–º–∏ –∫—Ä–µ—â–µ–Ω–∏—è
    persons_with_chr = [p for p in persons.values() if p.christening_date and p.given_name]

    for person in persons_with_chr:
        name = normalize_name(person.given_name)
        male_saints, female_saints = get_saints_for_date(person.christening_date, window)

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–æ–π –Ω–∞–±–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
        if person.sex == "M":
            saints = male_saints
        elif person.sex == "F":
            saints = female_saints
        else:
            saints = male_saints | female_saints

        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∏–º–µ–Ω–∞ —Å–≤—è—Ç—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        normalized_saints = {normalize_name(s) for s in saints}

        if name in normalized_saints:
            matches.append((person, "—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ", saints))
        elif any(name.startswith(s[:3]) for s in normalized_saints if len(s) >= 3):
            matches.append((person, "—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ", saints))
        else:
            mismatches.append((person, saints))

    # –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    print("=" * 100)
    print("–ê–ù–ê–õ–ò–ó –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø –ò–ú–Å–ù –î–ù–Ø–ú –ö–†–ï–©–ï–ù–ò–Ø –ü–û –°–í–Ø–¢–¶–ê–ú")
    print(f"(–æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞: ¬±{window} –¥–Ω–µ–π –æ—Ç –¥–∞—Ç—ã –∫—Ä–µ—â–µ–Ω–∏—è)")
    print("=" * 100)

    total = len(persons_with_chr)
    print(f"\n–í—Å–µ–≥–æ –ø–µ—Ä—Å–æ–Ω —Å –¥–∞—Ç–∞–º–∏ –∫—Ä–µ—â–µ–Ω–∏—è: {total}")
    print(f"–°–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å —Å–≤—è—Ç—Ü–∞–º–∏: {len(matches)} ({len(matches)*100//total if total else 0}%)")
    print(f"–ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: {len(mismatches)} ({len(mismatches)*100//total if total else 0}%)")

    # –ê–Ω–∞–ª–∏–∑ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –ø–æ–∏—Å–∫–æ–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
    found_namesakes = []
    no_namesakes = []

    for person, saints in mismatches:
        relatives = find_relatives(person, persons, families)
        namesakes = find_namesakes(person, relatives)

        if namesakes:
            found_namesakes.append((person, namesakes, saints))
        else:
            no_namesakes.append((person, saints))

    # –í—ã–≤–æ–¥–∏–º –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç—ë–∑–æ–∫
    print("\n" + "=" * 100)
    print(f"‚úÖ –ù–ê–ô–î–ï–ù–´ –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –¢–Å–ó–ö–ò-–†–û–î–°–¢–í–ï–ù–ù–ò–ö–ò: {len(found_namesakes)}")
    print("=" * 100)

    for person, namesakes, saints in found_namesakes:
        chr_date = person.christening_date.strftime('%d.%m.%Y') if person.christening_date else "?"
        julian_mark = " (—Å—Ç.—Å—Ç.)" if person.is_julian else ""

        print(f"\nüë§ {person.name}")
        print(f"   üìÖ –ö—Ä–µ—â–µ–Ω–∏–µ: {chr_date}{julian_mark}")
        print(f"   üìõ –ò–º—è: {person.given_name}")
        print(f"   üîó –í–æ–∑–º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞–Ω(–∞) –≤ —á–µ—Å—Ç—å:")

        for relation_type, namesake in namesakes:
            ns_birth = ""
            if namesake.birth_year:
                ns_birth = f", —Ä. {namesake.birth_year}"
            elif namesake.birth_date:
                ns_birth = f", —Ä. {namesake.birth_date.strftime('%d.%m.%Y')}"

            ns_death = ""
            if namesake.death_date:
                ns_death = f", ‚Ä† {namesake.death_date.strftime('%d.%m.%Y')}"

            print(f"      ‚Üí {namesake.name} ({relation_type}{ns_birth}{ns_death})")

    # –í—ã–≤–æ–¥–∏–º –±–µ–∑ —Ç—ë–∑–æ–∫
    print("\n" + "=" * 100)
    print(f"‚ùì –¢–Å–ó–ö–ò –ù–ï –ù–ê–ô–î–ï–ù–´: {len(no_namesakes)}")
    print("=" * 100)

    for person, saints in no_namesakes:
        chr_date = person.christening_date.strftime('%d.%m.%Y') if person.christening_date else "?"
        julian_mark = " (—Å—Ç.—Å—Ç.)" if person.is_julian else ""

        print(f"\nüë§ {person.name}")
        print(f"   üìÖ –ö—Ä–µ—â–µ–Ω–∏–µ: {chr_date}{julian_mark}")
        print(f"   üìõ –ò–º—è: {person.given_name}")
        if saints:
            saints_str = ", ".join(sorted(saints)[:10])
            if len(saints) > 10:
                saints_str += f"... (–≤—Å–µ–≥–æ {len(saints)})"
            print(f"   üìñ –°–≤—è—Ç—ã–µ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥: {saints_str}")

    # –í—ã–≤–æ–¥–∏–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
    print("\n" + "=" * 100)
    print(f"‚úÖ –ò–ú–ï–ù–ê –ü–û –°–í–Ø–¢–¶–ê–ú: {len(matches)}")
    print("=" * 100)

    for person, match_type, saints in matches[:20]:
        chr_date = person.christening_date.strftime('%d.%m.%Y') if person.christening_date else "?"
        julian_mark = " (—Å—Ç.—Å—Ç.)" if person.is_julian else ""

        print(f"\n‚úÖ {chr_date}{julian_mark} ‚Äî {person.given_name} ({match_type})")
        print(f"   üë§ {person.name}")

    if len(matches) > 20:
        print(f"\n... –∏ –µ—â—ë {len(matches) - 20} —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π")

    # –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print("\n" + "=" * 100)
    print("–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê")
    print("=" * 100)
    print(f"–í—Å–µ–≥–æ –∏–º—ë–Ω –Ω–µ –ø–æ —Å–≤—è—Ç—Ü–∞–º: {len(mismatches)}")
    print(f"  ‚îú‚îÄ –ù–∞–π–¥–µ–Ω—ã —Ç—ë–∑–∫–∏-—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏: {len(found_namesakes)} ({100*len(found_namesakes)//len(mismatches) if mismatches else 0}%)")
    print(f"  ‚îî‚îÄ –¢—ë–∑–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã: {len(no_namesakes)} ({100*len(no_namesakes)//len(mismatches) if mismatches else 0}%)")
    print(f"–ò–º–µ–Ω–∞ –ø–æ —Å–≤—è—Ç—Ü–∞–º: {len(matches)} ({100*len(matches)//total if total else 0}%)")


def main():
    parser = argparse.ArgumentParser(
        description="–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏–º—ë–Ω –¥–Ω—é –∫—Ä–µ—â–µ–Ω–∏—è –ø–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–º —Å–≤—è—Ç—Ü–∞–º"
    )
    parser.add_argument("gedcom_file", help="–ü—É—Ç—å –∫ GEDCOM —Ñ–∞–π–ª—É")
    parser.add_argument(
        "--window", "-w",
        type=int,
        default=8,
        help="–û–∫–Ω–æ –ø–æ–∏—Å–∫–∞ –≤ –¥–Ω—è—Ö –≤–æ–∫—Ä—É–≥ –¥–∞—Ç—ã –∫—Ä–µ—â–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 8)"
    )

    args = parser.parse_args()

    print(f"–ü–∞—Ä—Å–∏–Ω–≥ GEDCOM —Ñ–∞–π–ª–∞: {args.gedcom_file}")
    persons, families = parse_gedcom_full(args.gedcom_file)
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(persons)} –ø–µ—Ä—Å–æ–Ω –∏ {len(families)} —Å–µ–º–µ–π")

    persons_with_chr = [p for p in persons.values() if p.christening_date]
    if not persons_with_chr:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫—Ä–µ—â–µ–Ω–∏—è—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.")
        return

    analyze_namedays(persons, families, args.window)


if __name__ == "__main__":
    main()
